(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{"3DFs":function(v,t,_){"use strict";_.r(t);var e=_("KHd+"),d=Object(e.a)({},function(){var v=this,t=v.$createElement;v._self._c;return v._m(0)},[function(){var v=this,t=v.$createElement,_=v._self._c||t;return _("div",{staticClass:"markdown"},[_("h2",[v._v("Upload 组件")]),v._v(" "),_("blockquote",[_("p",[v._v("1.3.0 新增")])]),v._v(" "),_("p",[_("code",[v._v("Upload")]),v._v(" 上传组件。")]),v._v(" "),_("p",[_("strong",[v._v("注：")]),v._v(" 本文中所有的原始文件对象统称为"),_("strong",[v._v("原始文件")]),v._v("，而经过包装后的文件对象称为"),_("strong",[v._v("文件对象")]),v._v("，这个文件对象的结构如下：")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[v._v("属性")]),v._v(" "),_("th",[v._v("说明")]),v._v(" "),_("th",[v._v("类型")])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("name")]),v._v(" "),_("td",[v._v("文件名")]),v._v(" "),_("td",[v._v("String")])]),v._v(" "),_("tr",[_("td",[v._v("size")]),v._v(" "),_("td",[v._v("文件大小")]),v._v(" "),_("td",[v._v("Number")])]),v._v(" "),_("tr",[_("td",[v._v("url")]),v._v(" "),_("td",[v._v("文件 url，通过 URL.createObjectURL 获得")]),v._v(" "),_("td",[v._v("String")])]),v._v(" "),_("tr",[_("td",[v._v("base64")]),v._v(" "),_("td",[v._v("文件 base64 的值，这个会从原始文件的 base64 属性获得（默认是没有的，但是插件可以添加，例如下边演示的压缩 compress 插件就会添加 base64 值）")]),v._v(" "),_("td",[v._v("String")])]),v._v(" "),_("tr",[_("td",[v._v("status")]),v._v(" "),_("td",[v._v("文件状态，包含四个： ready, uploading, success, error")]),v._v(" "),_("td",[v._v("String")])]),v._v(" "),_("tr",[_("td",[v._v("progress")]),v._v(" "),_("td",[v._v("文件上传进度，小数 0~1")]),v._v(" "),_("td",[v._v("Number")])]),v._v(" "),_("tr",[_("td",[v._v("file")]),v._v(" "),_("td",[v._v("原始文件")]),v._v(" "),_("td",[v._v("File")])]),v._v(" "),_("tr",[_("td",[v._v("response")]),v._v(" "),_("td",[v._v("响应内容（自动转 JSON）")]),v._v(" "),_("td",[v._v("Object/Array/String")])]),v._v(" "),_("tr",[_("td",[v._v("responseHeaders")]),v._v(" "),_("td",[v._v("响应头")]),v._v(" "),_("td",[v._v("String")])])])]),v._v(" "),_("h3",[v._v("示例")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("基本用法")]),v._v(" "),_("pre",[_("code",{staticClass:"language-html"},[v._v('<cube-upload\n  action="//jsonplaceholder.typicode.com/photos/"\n  :simultaneous-uploads="1"\n  @files-added="filesAdded" />\n')])]),v._v(" "),_("pre",[_("code",{staticClass:"language-js"},[v._v("export default {\n  methods: {\n    filesAdded(files) {\n      let hasIgnore = false\n      const maxSize = 1 * 1024 * 1024 // 1M\n      for (let k in files) {\n        const file = files[k]\n        if (file.size > maxSize) {\n          file.ignore = true\n          hasIgnore = true\n        }\n      }\n      hasIgnore && this.$createToast({\n        type: 'warn',\n        time: 1000,\n        txt: 'You selected >1M files'\n      }).show()\n    }\n  }\n}\n")])]),v._v(" "),_("p",[v._v("配置 "),_("code",[v._v("action")]),v._v(" 表示上传的 URL 地址，而 "),_("code",[v._v("simultaneous-uploads")]),v._v(" 则表示支持的并发上传个数。")]),v._v(" "),_("p",[v._v("通过 "),_("code",[v._v("files-added")]),v._v(" 事件可以实现文件过滤，设置 "),_("code",[v._v("file.ignore = true")]),v._v(" 即可。")])]),v._v(" "),_("li",[_("p",[v._v("压缩图片且通过 Base64 上传")]),v._v(" "),_("pre",[_("code",{staticClass:"language-html"},[v._v('<cube-upload\n  ref="upload"\n  :action="action"\n  :simultaneous-uploads="1"\n  :process-file="processFile"\n  @file-submitted="fileSubmitted" />\n')])]),v._v(" "),_("pre",[_("code",{staticClass:"language-js"},[v._v("import compress from '../../modules/image'\nexport default {\n  data() {\n    return {\n      action: {\n        target: '//jsonplaceholder.typicode.com/photos/',\n        prop: 'base64Value'\n      }\n    }\n  },\n  methods: {\n    processFile(file, next) {\n      compress(file, {\n        compress: {\n          width: 1600,\n          height: 1600,\n          quality: 0.5\n        }\n      }, next)\n    },\n    fileSubmitted(file) {\n      file.base64Value = file.file.base64\n    }\n  }\n}\n")])]),v._v(" "),_("p",[_("code",[v._v("action")]),v._v(" 中除了有 "),_("code",[v._v("target")]),v._v(" 目标上传地址外；还有 "),_("code",[v._v("prop")]),v._v(" 配置，表示上传的时候采用处理后的 "),_("code",[v._v("file")]),v._v(" 普通对象的哪个属性所对应的值上传，这里设置的就是 "),_("code",[v._v("base64Value")]),v._v(" 的值。")]),v._v(" "),_("p",[_("code",[v._v("process-file")]),v._v(" 则是一个函数，主要用于处理原生文件的，调用 "),_("code",[v._v("next")]),v._v(" 回调的话，参数是处理完的文件对象，这里示例的就是调用 "),_("code",[v._v("compress")]),v._v(" 做压缩，处理完后会回调 "),_("code",[v._v("next")]),v._v("。")]),v._v(" "),_("p",[_("code",[v._v("file-submitted")]),v._v(" 事件则是每个文件处理完后添加到 "),_("code",[v._v("upload")]),v._v(" 实例的 "),_("code",[v._v("files")]),v._v(" 数组中后触发，参数就是一个处理后的文件对象。")])]),v._v(" "),_("li",[_("p",[v._v("自定义结构样式")]),v._v(" "),_("p",[v._v("使用默认插槽来实现自定义结构，在此基础上自定义样式。")]),v._v(" "),_("pre",[_("code",{staticClass:"language-html"},[v._v('<cube-upload\n  ref="upload"\n  v-model="files"\n  :action="action"\n  @files-added="addedHandler"\n  @file-error="errHandler">\n  <div class="clear-fix">\n    <cube-upload-file v-for="(file, i) in files" :file="file" :key="i"></cube-upload-file>\n    <cube-upload-btn :multiple="false">\n      <div>\n        <i>＋</i>\n        <p>Please click to upload ID card</p>\n      </div>\n    </cube-upload-btn>\n  </div>\n</cube-upload>\n')])]),v._v(" "),_("pre",[_("code",{staticClass:"language-js"},[v._v("export default {\n  data() {\n    return {\n      action: '//jsonplaceholder.typicode.com/photos/',\n      files: []\n    }\n  },\n  methods: {\n    addedHandler() {\n      const file = this.files[0]\n      file && this.$refs.upload.removeFile(file)\n    },\n    errHandler(file) {\n      // const msg = file.response.message\n      this.$createToast({\n        type: 'warn',\n        txt: 'Upload fail',\n        time: 1000\n      }).show()\n    }\n  }\n}\n")])]),v._v(" "),_("p",[v._v("样式覆盖：")]),v._v(" "),_("pre",[_("code",{staticClass:"language-stylus"},[v._v(".cube-upload\n  .cube-upload-file, .cube-upload-btn\n    margin: 0\n    height: 200px\n  .cube-upload-file\n    margin: 0\n    + .cube-upload-btn\n      margin-top: -200px\n      opacity: 0\n  .cube-upload-file-def\n    width: 100%\n    height: 100%\n    .cubeic-wrong\n      display: none\n  .cube-upload-btn\n    display: flex\n    align-items: center\n    justify-content: center\n    > div\n      text-align: center\n    i\n      display: inline-flex\n      align-items: center\n      justify-content: center\n      width: 50px\n      height: 50px\n      margin-bottom: 20px\n      font-size: 32px\n      line-height: 1\n      font-style: normal\n      color: #fff\n      background-color: #333\n      border-radius: 50%\n")])]),v._v(" "),_("p",[v._v("上述示例实现的效果就是点击上传（一次只能选择一张）一张图片，此图片就会直接展示，而上传按钮本身则是不可见，覆盖在图片预览区域上。再次重新选择图片，就会移除掉上次选择的图片，重新展示新选择的图片。")])])]),v._v(" "),_("h3",[v._v("Props 配置")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[v._v("参数")]),v._v(" "),_("th",[v._v("说明")]),v._v(" "),_("th",[v._v("类型")]),v._v(" "),_("th",[v._v("默认值")]),v._v(" "),_("th",[v._v("示例")])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("v-model")]),v._v(" "),_("td",[v._v("文件列表")]),v._v(" "),_("td",[v._v("Array")]),v._v(" "),_("td",[v._v("[]")]),v._v(" "),_("td",[v._v("[{ name, size, url, status: 'success', progress: 1 }]")])]),v._v(" "),_("tr",[_("td",[v._v("action")]),v._v(" "),_("td",[v._v("上传行为配置项，最少包含上传目标的 URL 地址")]),v._v(" "),_("td",[v._v("String/Object")]),v._v(" "),_("td",[v._v("''")]),v._v(" "),_("td",[v._v("{ target: '/upload' }")])]),v._v(" "),_("tr",[_("td",[v._v("max")]),v._v(" "),_("td",[v._v("最大上传文件个数")]),v._v(" "),_("td",[v._v("Number")]),v._v(" "),_("td",[v._v("10")]),v._v(" "),_("td",[v._v("-")])]),v._v(" "),_("tr",[_("td",[v._v("auto")]),v._v(" "),_("td",[v._v("是否自动上传，即选择完文件后自动开始上传")]),v._v(" "),_("td",[v._v("Boolean")]),v._v(" "),_("td",[v._v("true")]),v._v(" "),_("td",[v._v("-")])]),v._v(" "),_("tr",[_("td",[v._v("simultaneousUploads")]),v._v(" "),_("td",[v._v("并发上传数")]),v._v(" "),_("td",[v._v("Number")]),v._v(" "),_("td",[v._v("1")]),v._v(" "),_("td",[v._v("-")])]),v._v(" "),_("tr",[_("td",[v._v("multiple")]),v._v(" "),_("td",[v._v("是否多选")]),v._v(" "),_("td",[v._v("Boolean")]),v._v(" "),_("td",[v._v("true")]),v._v(" "),_("td",[v._v("-")])]),v._v(" "),_("tr",[_("td",[v._v("accept")]),v._v(" "),_("td",[v._v("input 的 accept 属性值")]),v._v(" "),_("td",[v._v("String")]),v._v(" "),_("td",[v._v("image/*")]),v._v(" "),_("td",[v._v("-")])]),v._v(" "),_("tr",[_("td",[v._v("processFile")]),v._v(" "),_("td",[v._v("处理原始文件函数")]),v._v(" "),_("td",[v._v("Function")]),v._v(" "),_("td",[v._v("function (file, next) { next(file) }")]),v._v(" "),_("td",[v._v("-")])])])]),v._v(" "),_("ul",[_("li",[_("code",[v._v("action")]),v._v(" 子配置项")])]),v._v(" "),_("p",[v._v("如果 "),_("code",[v._v("action")]),v._v(" 是字符串，则会被处理成 "),_("code",[v._v("{ target: action }")]),v._v(" 这样结构。")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[v._v("参数")]),v._v(" "),_("th",[v._v("说明")]),v._v(" "),_("th",[v._v("类型")]),v._v(" "),_("th",[v._v("默认值")])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("target")]),v._v(" "),_("td",[v._v("上传目标 URL，如果为函数，则传入当前文件对象调用得到目标 URL")]),v._v(" "),_("td",[v._v("String/Function<sup>1.11.0+</sup>")]),v._v(" "),_("td",[v._v("-")])]),v._v(" "),_("tr",[_("td",[v._v("fileName")]),v._v(" "),_("td",[v._v("上传文件时文件的参数名")]),v._v(" "),_("td",[v._v("String")]),v._v(" "),_("td",[v._v("'file'")])]),v._v(" "),_("tr",[_("td",[v._v("prop")]),v._v(" "),_("td",[v._v("上传的时候使用文件对象的 prop 属性所对应的值")]),v._v(" "),_("td",[v._v("String")]),v._v(" "),_("td",[v._v("'file'")])]),v._v(" "),_("tr",[_("td",[v._v("headers")]),v._v(" "),_("td",[v._v("自定义请求头，如果为函数，则传入当前文件对象调用得到 headers")]),v._v(" "),_("td",[v._v("Object/Function<sup>1.11.0+</sup>")]),v._v(" "),_("td",[v._v("{}")])]),v._v(" "),_("tr",[_("td",[v._v("data")]),v._v(" "),_("td",[v._v("上传需要附加数据，如果为函数，则传入当前文件对象调用得到 data")]),v._v(" "),_("td",[v._v("Object/Function<sup>1.11.0+</sup>")]),v._v(" "),_("td",[v._v("{}")])]),v._v(" "),_("tr",[_("td",[v._v("withCredentials")]),v._v(" "),_("td",[v._v("标准的 CORS 请求是不会带上 cookie 的，如果想要带的话需要设置 withCredentials 为 true")]),v._v(" "),_("td",[v._v("Boolean")]),v._v(" "),_("td",[v._v("false")])]),v._v(" "),_("tr",[_("td",[v._v("timeout")]),v._v(" "),_("td",[v._v("请求超时时间")]),v._v(" "),_("td",[v._v("Number")]),v._v(" "),_("td",[v._v("0")])]),v._v(" "),_("tr",[_("td",[v._v("progressInterval")]),v._v(" "),_("td",[v._v("进度回调间隔（单位：ms）")]),v._v(" "),_("td",[v._v("Number")]),v._v(" "),_("td",[v._v("100")])]),v._v(" "),_("tr",[_("td",[v._v("checkSuccess")]),v._v(" "),_("td",[v._v("校验是否成功函数，参数为"),_("code",[v._v("(服务端响应数据, 当前文件对象 [,cb 回调])")]),v._v("，注意第二个参数和第三个参数是 1.11.0 后新增的，而参数 "),_("code",[v._v("cb")]),v._v(" 是可选的，异步场景可用，如果没有 "),_("code",[v._v("cb")]),v._v(" 则取其返回值，如果结果值为 true 则代表成功")]),v._v(" "),_("td",[v._v("Function")]),v._v(" "),_("td",[v._v("function (res, file) { return true }")])])])]),v._v(" "),_("ul",[_("li",[_("code",[v._v("processFile")]),v._v(" 子配置项")])]),v._v(" "),_("p",[v._v("一个函数，这个函数有两个参数："),_("code",[v._v("(file, next)")]),v._v("，"),_("code",[v._v("file")]),v._v(" 就是原始文件，"),_("code",[v._v("next")]),v._v(" 为处理完毕后的回调函数，调用的时候需要传入处理后的文件。")]),v._v(" "),_("h3",[v._v("事件")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[v._v("事件名")]),v._v(" "),_("th",[v._v("说明")]),v._v(" "),_("th",[v._v("参数")])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("files-added")]),v._v(" "),_("td",[v._v("选择完文件后触发，一般可用作文件过滤")]),v._v(" "),_("td",[v._v("原始文件列表")])]),v._v(" "),_("tr",[_("td",[v._v("file-submitted")]),v._v(" "),_("td",[v._v("每个文件处理完后添加到 "),_("code",[v._v("upload")]),v._v(" 实例的 "),_("code",[v._v("files")]),v._v(" 数组中后触发")]),v._v(" "),_("td",[v._v("文件对象")])]),v._v(" "),_("tr",[_("td",[v._v("file-removed")]),v._v(" "),_("td",[v._v("文件被删除后触发")]),v._v(" "),_("td",[v._v("文件对象")])]),v._v(" "),_("tr",[_("td",[v._v("file-success")]),v._v(" "),_("td",[v._v("文件上传成功后触发")]),v._v(" "),_("td",[v._v("文件对象")])]),v._v(" "),_("tr",[_("td",[v._v("file-error")]),v._v(" "),_("td",[v._v("文件上传失败后触发")]),v._v(" "),_("td",[v._v("文件对象")])]),v._v(" "),_("tr",[_("td",[v._v("file-click")]),v._v(" "),_("td",[v._v("文件点击后触发")]),v._v(" "),_("td",[v._v("文件对象")])]),v._v(" "),_("tr",[_("td",[v._v("input")]),v._v(" "),_("td",[v._v("绑定值（文件列表）改变后触发")]),v._v(" "),_("td",[v._v("更新后的绑定值（文件列表）")])])])]),v._v(" "),_("h3",[v._v("实例方法")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[v._v("方法名")]),v._v(" "),_("th",[v._v("说明")]),v._v(" "),_("th",[v._v("参数")])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("start")]),v._v(" "),_("td",[v._v("开始上传")]),v._v(" "),_("td",[v._v("-")])]),v._v(" "),_("tr",[_("td",[v._v("pause")]),v._v(" "),_("td",[v._v("暂停上传")]),v._v(" "),_("td",[v._v("-")])]),v._v(" "),_("tr",[_("td",[v._v("retry")]),v._v(" "),_("td",[v._v("重试上传")]),v._v(" "),_("td",[v._v("-")])]),v._v(" "),_("tr",[_("td",[v._v("removeFile")]),v._v(" "),_("td",[v._v("删除文件")]),v._v(" "),_("td",[v._v("文件对象")])])])])])}],!1,null,null,null);t.default=d.exports}}]);