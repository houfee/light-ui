(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{q33b:function(e,o,n){"use strict";n.r(o);var a=n("KHd+"),i=Object(a.a)({},function(){var e=this,o=e.$createElement;e._self._c;return e._m(0)},[function(){var e=this,o=e.$createElement,n=e._self._c||o;return n("div",{staticClass:"markdown"},[n("h2",[e._v("Post-compile")]),e._v(" "),n("p",[e._v("Post-compile means the NPM packages don't need to be compiled before published, and they will be compiled along with the application's compiling.")]),e._v(" "),n("blockquote",[n("p",[e._v("Notes: For more detailed content about post-compile, see "),n("a",{attrs:{href:"https://github.com/DDFE/DDFE-blog/issues/23"}},[e._v("webpack 应用编译优化之路")]),e._v(".")])]),e._v(" "),n("h3",[e._v("Background")]),e._v(" "),n("p",[e._v("More and more applications are developed with webpack + babel, and commonly use NPM to manage packages. With the growing of the number of package dependencies which are also developed with ES2015+ and need to be compiled before published, the final compiled code usually contains a lot of compiling code. Therefore, to eliminate the redundancy, we recommend post-compile.")]),e._v(" "),n("h3",[e._v("Pros and cons")]),e._v(" "),n("p",[e._v("Pros:")]),e._v(" "),n("ul",[n("li",[e._v("Common dependencies can be shared and only need to be compiled once.")]),e._v(" "),n("li",[e._v("Only one copy of babel-plugin-transform-runtime or babel-polyfill code.")]),e._v(" "),n("li",[e._v("The NPM packages don't need to be compiled before published.")])]),e._v(" "),n("p",[e._v("Cons:")]),e._v(" "),n("ul",[n("li",[e._v("The application's babel configuration needs to be compatible with  the NPM packages' babel configuration.")]),e._v(" "),n("li",[e._v("The NPM packages can't use alias and DefinePlugin (you can use them and compiled before published but don't need to use babel).")]),e._v(" "),n("li",[e._v("The application's compiling time will be longer.")])]),e._v(" "),n("h3",[e._v("Rules")]),e._v(" "),n("p",[e._v("Considering some applications can not use post-compile, cube-ui used the rule:")]),e._v(" "),n("blockquote",[n("p",[e._v("The main field in package.json is the compiled entry point and the module field is the source entry point.")])]),e._v(" "),n("p",[n("em",[e._v("About "),n("a",{attrs:{href:"https://github.com/rollup/rollup/wiki/pkg.module"}},[e._v("pkg.module")])])]),e._v(" "),n("p",[e._v("Post-compile is used by default if you use webpack 2+. Of course, you can use the webpack alias configuration to change the default behavior.")]),e._v(" "),n("h3",[e._v("webpack demo")]),e._v(" "),n("p",[e._v("The "),n("a",{attrs:{href:"https://www.npmjs.com/package/webpack-post-compile-plugin"}},[e._v("webpack-post-compile-plugin")]),e._v(" is used to resolve the nested post-compile NPM packages.")]),e._v(" "),n("p",[e._v("An example of your application webpack configuration:")]),e._v(" "),n("pre",[n("code",{staticClass:"language-js"},[e._v("// webpack.config.js\nvar PostCompilePlugin = require('webpack-post-compile-plugin')\n\nmodule.exports = {\n  // ...\n  module: {\n    rules: [\n      // ...\n      {\n        test: /\\.js$/,\n        loader: 'babel-loader',\n        include: [\n          resolve('src')\n        ]\n      },\n      // ...\n    ]\n  },\n  // ...\n  plugins: [\n    new PostCompilePlugin()\n  ]\n}\n")])]),e._v(" "),n("p",[e._v("And if you can control all the packages which you want to post compile, you can just add postCompile: true to the packages package.json:")]),e._v(" "),n("pre",[n("code",{staticClass:"language-js"},[e._v('{\n  "name": "your-one-pkg",\n  // ...\n  "postCompile": true\n  // ...\n}\n')])]),e._v(" "),n("p",[e._v("Or you can add compileDependencies to your application package.json:")]),e._v(" "),n("pre",[n("code",{staticClass:"language-js"},[e._v('// package.json\n{\n  // ...\n  "compileDependencies": ["A", "B"]\n  // ...\n}\n')])]),e._v(" "),n("p",[e._v("If "),n("code",[e._v("A")]),e._v(" package have a dependency on "),n("code",[e._v("C")]),e._v(" which is needed to be post compiled, just add "),n("code",[e._v("compileDependencies")]),e._v(" to "),n("code",[e._v("A")]),e._v("'s  package.json:")]),e._v(" "),n("pre",[n("code",{staticClass:"language-json"},[e._v('// A package.json\n{\n  // ...\n  "compileDependencies": ["C"]\n  // ...\n}\n')])])])}],!1,null,null,null);o.default=i.exports}}]);